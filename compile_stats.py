import json
import os
import getopt, sys
import ast

# These are editable fields to configure which folders the
# script will attempt to aggregate.
base_folder_name = 'itch_extract_'

all_games = {}
i = 1
# for i in range(1, n_folders + 1):
while True:
	cur_folder = base_folder_name + str(i)
	target_file = cur_folder + '_logs/' + cur_folder + '_stats.txt'
	full_path = os.getcwd() + '/' + target_file

	if not os.path.exists(full_path):
		print(target_file + " does not exist. Done.")
		break
	else:
		print("Parsing stats for " + target_file)

	with open(full_path, 'r') as lf:
		for line in lf:
			line_parts = line.split(' :== ')
			if len(line_parts) == 2:
				all_games[line_parts[0]] = ast.literal_eval(line_parts[1].strip())

	i += 1

print("Number of games: " + str(len(all_games.keys())))

#todo: write out all games
with open(os.getcwd() + '/all_data.txt', 'w+') as f:
	f.write(str(all_games))