# extract files
# need to wait until everything has downloaded before doing this
# will need to expand if other extensions are found
# need to do 'pip3 install rarfile' and 'brew install unrar' first
import os
import zipfile, tarfile
from rarfile import RarFile

dir_name = '/Users/esthergoldstein/itchingtofindsomemalware/downloads'
extracted_name = '/Users/esthergoldstein/itchingtofindsomemalware/extracted'

os.chdir(dir_name) # change directory from working dir to dir with files

for item in os.listdir(dir_name): # loop through items in dir
    if item == ".DS_Store":
        continue
    file_name = os.path.abspath(item) # get full path of files
    if item.endswith(".zip"): # check for ".zip" extension
        zip_ref = zipfile.ZipFile(file_name) # create zipfile object
        zip_ref.extractall(extracted_name) # extract file to dir
        zip_ref.close() # close file
    elif item.endswith(".tar") or item.endswith(".tar.gz"):
        tf = tarfile.open(item)
        tf.extractall(extracted_name)
        tf.close()
    elif item.endswith(".rar"):
        with RarFile(file_name) as rf:
            rf.extractall(extracted_name)
            rf.close()